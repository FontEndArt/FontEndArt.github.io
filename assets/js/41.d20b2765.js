(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{250:function(e,v,_){"use strict";_.r(v);var t=_(0),r=Object(t.a)({},(function(){var e=this,v=e.$createElement,_=e._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("h1",{attrs:{id:"vue主线剧情之createelement"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#vue主线剧情之createelement"}},[e._v("#")]),e._v(" Vue主线剧情之createElement")]),e._v(" "),_("h2",{attrs:{id:"前言"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[e._v("#")]),e._v(" 前言")]),e._v(" "),_("p",[e._v("上回说到 "),_("code",[e._v("render")]),e._v(" 函数最终是执行 "),_("code",[e._v("createElement")]),e._v(" 方法，返回 "),_("code",[e._v("vnode")]),e._v(" 节点。这次就让我们来看看 "),_("code",[e._v("createElement")]),e._v(" 内部做了些什么。")]),e._v(" "),_("h2",{attrs:{id:"源码及分析"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#源码及分析"}},[e._v("#")]),e._v(" 源码及分析")]),e._v(" "),_("p",[e._v("从 "),_("code",[e._v("src/core/instance/render.js")]),e._v(" 中看到了， "),_("code",[e._v("createElement")]),e._v(" 方法在 "),_("code",[e._v("src/core/vdom/create-element.js")]),e._v(" 文件中。")]),e._v(" "),_("p",[_("a",{attrs:{href:"https://github.com/vuejs/vue/blob/dev/src/core/vdom/create-element.js#L28-L136",target:"_blank",rel:"noopener noreferrer"}},[e._v("点击查看createElement源码"),_("OutboundLink")],1)]),e._v(" "),_("p",[e._v("看源码第一步，抓重点：")]),e._v(" "),_("ul",[_("li",[e._v("createEmptyVNode 创建空的vnode")]),e._v(" "),_("li",[e._v("createComponent 创建组件")]),e._v(" "),_("li",[e._v("normalizeChildren 规范的children")]),e._v(" "),_("li",[e._v("simpleNormalizeChildren 简单的规范的children")])]),e._v(" "),_("p",[e._v("第二步，看一下执行步骤：")]),e._v(" "),_("ul",[_("li",[e._v("判断tag是否存在，不存在则创建一个空节点")]),e._v(" "),_("li",[e._v("如果传递了children， 根据 "),_("code",[e._v("normalizationType")]),e._v(" 调用 "),_("code",[e._v("normalizeChildren(children)")]),e._v(" / "),_("code",[e._v("simpleNormalizeChildren(children)")])]),e._v(" "),_("li",[e._v("对参数 "),_("code",[e._v("tag")]),e._v(" 的判断， 如果是一个普通的 html 标签，实例化为一个VNode节点，如果是 component 则通过 createComponent 创建一个组件的 vnode。")])]),e._v(" "),_("blockquote",[_("p",[e._v("这里可能需要自己再去揣摩一下，大概就是把普通的VNode节点和组件的VNode做一个分别创建")])]),e._v(" "),_("h2",{attrs:{id:"总结"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),_("p",[e._v("因为除了组件的 "),_("code",[e._v("vnode")]),e._v(" 没有 "),_("code",[e._v("children")]),e._v("，而其他通过 "),_("code",[e._v("createElement")]),e._v(" 创建的每个 "),_("code",[e._v("vnode")]),e._v(" 都有 "),_("code",[e._v("children")]),e._v("，并且 "),_("code",[e._v("children")]),e._v(" 每个元素也是一个 "),_("code",[e._v("vnode")]),e._v("。")]),e._v(" "),_("p",[e._v("这样就形成了一个完整的 "),_("code",[e._v("vnode tree")]),e._v("，这样我们就知道 "),_("code",[e._v("vm._render")]),e._v(" 阶段是如何创建的 vnode。")]),e._v(" "),_("p",[e._v("那么接下来我们就去看看 "),_("code",[e._v("vm._update")]),e._v("，看看是如何将 "),_("code",[e._v("vnode")]),e._v(" 渲染成"),_("strong",[e._v("真实 "),_("code",[e._v("dom")])]),e._v(" 的。")])])}),[],!1,null,null,null);v.default=r.exports}}]);